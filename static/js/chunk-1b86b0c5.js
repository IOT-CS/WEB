(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1b86b0c5"],{"36ee":function(e,t,i){"use strict";i.r(t);i("6b54"),i("a481");var a={components:{easyflow:i("f08a").default},data:function(){return{currentPage:1,pagesize:10,rulesList:[],dialogVisible:!1,formType:"",nodeData:"",formData:{},dataTopics:[],dataResouces:[],rules:{Topic:[{required:!0,message:"Topic不能为空",trigger:"blur"}],ResourceId:[{required:!0,message:"资源不能为空",trigger:"blur"}]}}},mounted:function(){this.initData(),this.initTopicAndResource()},methods:{handleSizeChange:function(e){this.pagesize=e,console.log(this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,console.log(this.currentPage)},handleView:function(e,t){},handleEdit:function(e,t){this.formType="edit",this.formData=t,this.resourceTitle="配置资源",this.dialogVisible=!0},handleDelete:function(e,t){var i=this;return this.$confirm("确定要删除当前数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then((function(){t.lineList="",t.name="",t.nodeList="",i.$post("rule/relationship/delete",{Id:t.Id}).then((function(e){e.Successful&&(i.initData(),i.$Message.success({message:"数据配置成功！",duration:800}))}))})).catch((function(){})),!0},getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;"add"==t.formType?(t.formData.Id=t.getUUID(),t.$post("rule/relationship/insert",t.formData).then((function(e){e.Successful?(t.initData(),t.closeDialog(),t.$Message.success({message:"数据配置成功！",duration:800})):t.$Message.error({message:e.ErrorMessage,duration:800})}))):t.$post("rule/relationship/update",t.formData).then((function(e){e.Successful?(t.initData(),t.closeDialog(),t.$Message.success({message:"数据配置成功！",duration:800})):t.$Message.error({message:e.ErrorMessage,duration:800})}))}))},closeDialog:function(){this.dialogVisible=!1},addRule:function(){this.formType="add",this.formData={},this.dialogVisible=!0},querySearch:function(){},handleSelectInput:function(){},initTopicAndResource:function(){var e=this;this.$post("resource/data/get").then((function(t){t.Successful?t.Data&&(e.dataResouces=t.Data):e.$Message.error({message:t.ErrorMessage,duration:800})})),this.$get("rule/getTopics").then((function(t){t.Successful&&t.Data&&(e.dataTopics=t.Data)}))},initData:function(){var e=this;this.$post("rule/relationship/get").then((function(t){t.Successful?e.rulesList=t.Data:e.$Message.error({message:t.ErrorMessage,duration:800})}))}}},o=(i("88e0"),i("f6ac"),i("2877")),s=Object(o.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"div_rules"},[i("div",{staticClass:"div_ruleOpration"},[i("el-button",{staticStyle:{color:"rgb(64,158,255)"},attrs:{size:"small",icon:"el-icon-plus",title:"添加"},on:{click:e.addRule}},[e._v("添加")])],1),i("div",{staticClass:"div_ruleTables"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"100%",height:"96%"},attrs:{border:"",size:"mini",data:e.rulesList,"tooltip-effect":"dark","default-sort":{prop:"date",order:"descending"},"highlight-current-row":""}},[i("el-table-column",{attrs:{type:"index",label:"序号",sortable:"",width:"80"}}),i("el-table-column",{attrs:{prop:"Topic",label:"Topic"}}),i("el-table-column",{attrs:{prop:"ResourceName",label:"资源名称"}}),i("el-table-column",{attrs:{prop:"CreaterBy",label:"创建人",width:"100"}}),i("el-table-column",{attrs:{prop:"CreateTime",label:"创建日期",sortable:"",width:"180"}}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{color:"rgb(64,158,255)"},attrs:{type:"text",icon:"el-icon-edit",size:"mini"},on:{click:function(i){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),i("el-button",{staticStyle:{color:"rgb(247,137,137)"},attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(i){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e.dialogVisible?i("el-dialog",{staticClass:"dialog_box",attrs:{title:"Topic关联配置",width:"520px",visible:e.dialogVisible,"append-to-body":!0,"modal-append-to-body":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"formDeviceGroup",staticClass:"demo-form",staticStyle:{margin:"0 30px"},attrs:{model:e.formData,rules:e.rules,"label-position":"left","label-width":"120px"}},[i("el-form-item",{attrs:{label:"Topic",prop:"Topic"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.Topic,callback:function(t){e.$set(e.formData,"Topic",t)},expression:"formData.Topic"}},e._l(e.dataTopics,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),i("el-form-item",{attrs:{label:"资源",prop:"ResourceId"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formData.ResourceId,callback:function(t){e.$set(e.formData,"ResourceId",t)},expression:"formData.ResourceId"}},e._l(e.dataResouces,(function(e){return i("el-option",{key:e.Id,attrs:{label:e.ResourceName,value:e.Id}})})),1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("formDeviceGroup")}}},[e._v("确定")]),i("el-button",{on:{click:e.closeDialog}},[e._v("取消")])],1)],1)],1):e._e()],1)])}),[],!1,null,"3775197f",null);t.default=s.exports},"88e0":function(e,t,i){"use strict";i("e9744")},c90a:function(e,t,i){},e9744:function(e,t,i){},f6ac:function(e,t,i){"use strict";i("c90a")}}]);